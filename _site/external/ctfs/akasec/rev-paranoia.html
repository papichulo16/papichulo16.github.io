<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>REV - Paranoia | papichulo16</title>
  <link rel="stylesheet" href="/assets/css/style.css">
  
</head>
<body>
  <nav class="navbar">
    <a class="menu home-link" href="/"><img src="/assets/img/chavo.png" alt="El chavo" class="pfp-img">papichulo16</a>

    <div class="nav-right">
      <a href="https://github.com/papichulo16">Github</a>
      <a href="/contact">Contact</a>
      <a href="/reviews">Reviews</a>
      <div class="dropdown">
        <span><a href="/projects">Projects ▾</a></span>
        <div class="dropdown-content">
          
            <a href="/projects/1_magical_kernel.html">Magical Kernel</a>
          
            <a href="/projects/2_crap.html">C.R.A.P</a>
          
            <a href="/projects/6_ctf_writeups.html">PWN Writeups</a>
          
        </div>
      </div>
    </div>
  </nav>
  <hr>

  <main>
    <article class="post">

  <header class="post-header">
    <h1 class="post-title">REV - Paranoia</h1>
  </header>

  <div class="post-content">
    <h2 id="rev---paranoia">REV - Paranoia</h2>

<h4 id="ghidra-disassembler-code">Ghidra disassembler code</h4>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">undefined8</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
  <span class="kt">char</span> <span class="n">cVar1</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">iVar2</span><span class="p">;</span>
  <span class="kt">time_t</span> <span class="n">tVar3</span><span class="p">;</span>
  <span class="n">ulong</span> <span class="n">local_20</span><span class="p">;</span>
  
  <span class="n">tVar3</span> <span class="o">=</span> <span class="n">time</span><span class="p">((</span><span class="kt">time_t</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">);</span>
  <span class="n">srand</span><span class="p">((</span><span class="n">uint</span><span class="p">)</span><span class="n">tVar3</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">local_20</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">local_20</span> <span class="o">&lt;</span> <span class="mh">0x12</span><span class="p">;</span> <span class="n">local_20</span> <span class="o">=</span> <span class="n">local_20</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">cVar1</span> <span class="o">=</span> <span class="n">flag</span><span class="p">[</span><span class="n">local_20</span><span class="p">];</span>
    <span class="n">iVar2</span> <span class="o">=</span> <span class="n">rand</span><span class="p">();</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%i "</span><span class="p">,(</span><span class="n">ulong</span><span class="p">)(</span><span class="n">uint</span><span class="p">)(</span><span class="n">iVar2</span> <span class="o">%</span> <span class="mh">0x100</span> <span class="o">^</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">cVar1</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="n">putchar</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="python-script">Python script</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="n">CDLL</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span>

<span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">timestamp</span><span class="p">())</span>

<span class="n">libc</span> <span class="o">=</span> <span class="n">CDLL</span><span class="p">(</span><span class="s">"/lib/x86_64-linux-gnu/libc.so.6"</span><span class="p">)</span>
<span class="n">libc</span><span class="p">.</span><span class="n">srand</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>

<span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s">"./paranoia"</span><span class="p">)</span>

<span class="n">encoded</span> <span class="o">=</span> <span class="n">io</span><span class="p">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="n">encoded</span> <span class="o">=</span> <span class="n">encoded</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s">" "</span><span class="p">)</span>
<span class="n">encoded</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="sa">b</span><span class="s">""</span><span class="p">)</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">""</span>

<span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">encoded</span><span class="p">:</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>
    <span class="n">rand</span> <span class="o">=</span> <span class="n">libc</span><span class="p">.</span><span class="n">rand</span><span class="p">()</span>

    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span> <span class="n">rand</span> <span class="o">%</span> <span class="mh">0x100</span> <span class="o">^</span> <span class="n">cur</span> <span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</code></pre></div></div>

  </div>

</article>

  </main>

  <footer>
    <hr>
    © 2025 papichulo16
  </footer>
</body>
</html>

